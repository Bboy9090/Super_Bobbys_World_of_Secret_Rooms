{
  "version": "1.0.0",
  "name": "Lawful Lock Policy Pack",
  "principles": [
    "No circumvention. No bypass. No exploit guidance.",
    "User-initiated authentication only (no credential capture).",
    "All destructive actions require explicit typed confirmation.",
    "All runs produce immutable audit logs."
  ],
  "global": {
    "audit": {
      "enabled": true,
      "immutable": true,
      "fields": [
        "timestamp",
        "case_id",
        "user_id",
        "workflow_id",
        "step_id",
        "action",
        "args",
        "stdout",
        "stderr",
        "exit_code",
        "policy_gates",
        "confirmations"
      ]
    },
    "ui_language": {
      "banned_terms": [
        "bypass",
        "exploit",
        "activation lock removal",
        "icloud unlock",
        "remove icloud lock",
        "apple id bypass",
        "frp bypass",
        "unlock",
        "crack",
        "hack"
      ],
      "required_disclaimer": "This tool assists with diagnostics, ownership verification, and official recovery pathways. It does not bypass security or remove locks."
    }
  },
  "gates": [
    {
      "id": "GATE_OWNERSHIP_ATTESTATION",
      "name": "Ownership Attestation Required",
      "type": "ownership_attestation",
      "required": true,
      "message": "Ownership attestation is required before continuing.",
      "requirements": {
        "checkbox": "I own this device or have written permission to service it.",
        "typed_phrase": "I CONFIRM AUTHORIZED SERVICE"
      }
    },
    {
      "id": "GATE_EVIDENCE_COMPLETENESS",
      "name": "Evidence Completeness Check",
      "type": "evidence_completeness",
      "required": true,
      "message": "Sufficient evidence required for recovery pathway.",
      "requirements": {
        "minimumScore": 70,
        "pathwaySpecific": true
      }
    },
    {
      "id": "GATE_DEVICE_AUTHORIZATION",
      "name": "Device Authorization Check",
      "type": "device_authorization",
      "required": false,
      "message": "Device must be authorized for this operation.",
      "requirements": {
        "platformSpecific": true
      }
    },
    {
      "id": "GATE_DESTRUCTIVE_CONFIRMATION",
      "name": "Destructive Action Confirmation",
      "type": "destructive_confirmation",
      "required": false,
      "message": "Typed confirmation is required for destructive actions.",
      "requirements": {
        "typed_phrase": "ERASE AND RESTORE",
        "warning": "This may erase data. Ensure backups are complete. Proceed only if you understand the impact."
      }
    },
    {
      "id": "GATE_NO_CIRCUMVENTION",
      "name": "No Circumvention Allowed",
      "type": "blocked_intent",
      "required": true,
      "message": "This action is blocked because it resembles circumvention. Use official recovery pathways only.",
      "requirements": {
        "blocked_keywords": [
          "bypass",
          "exploit",
          "unlock icloud",
          "activation lock removal",
          "frp bypass",
          "mdm bypass",
          "crack",
          "hack"
        ]
      }
    }
  ],
  "rules": [
    {
      "id": "RULE_APPLE_RECOVERY_READ_ONLY",
      "name": "Apple Recovery is Read-Only",
      "applies_to": ["apple_account_recovery", "apple_support_request"],
      "constraints": {
        "allowed_actions": [
          "device_intake_readonly",
          "status_assessment_readonly",
          "ownership_packet_collect",
          "support_bundle_export",
          "official_handoff_links"
        ],
        "blocked_actions": [
          "lock_removal",
          "credential_capture",
          "server_simulation",
          "private_api_use"
        ]
      }
    },
    {
      "id": "RULE_ANDROID_SAFE",
      "name": "Android Operations Must Use OEM Sources",
      "applies_to": ["android_authorized_diagnostics"],
      "constraints": {
        "allowed_actions": [
          "device_intake_readonly",
          "authorized_adb_operations",
          "bootloader_status_read",
          "fastboot_getvar"
        ],
        "blocked_actions": [
          "unauthorized_access",
          "frp_bypass",
          "bootloader_unlock_automation"
        ]
      }
    }
  ]
}
